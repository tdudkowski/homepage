---
title: "Enigma cz. 3 - kryptologia 1918 - 1939"
section: "blog"
subsection: "historia"
set: enigma
date: 2021-08-13
edited:
image: ../images/Enigma-logo.jpg
tags: enigma, kryptologia, wwii
description: "Kontekst historyczny. Ogólna historia kryptologii w okresie międzywojennym, OTP i maszyny rotorowe."
---

Stały adres serii wpisów o Enigmie - [/blog/enigma](/blog/enigma)

Okres pomiędzy wojnami światowymi odznaczył się dwoma najważniejszymi rzeczami:

- Szyfr Vernama (OTP)
- maszyny rotorowe

Zacznijmy od pierwszej bo w tej kwestii panuje pewne pomieszanie terminów używanych potem w opisie niektórych maszyn szyfrujących.

Dodatkowo - polska kryptologia od odzyskania niepodłegłości aż do wojny (w zakresie poza dekryptażem Enigmy).

### Szyfr Vernama (OTP)

Najczęściej pojęcie szyfru Vernama stosuje się zamiennie z OTP (one-time-pad), ale jak się okazuje, nie jest to jednoznaczne.

Gilbert Sandford Vernam (1890-1960) w 1914 ukończył Worcester Polytechnic Institute, inżynier pracujący dla AT&T Bell Labs.

- w 1917 wymyślił polialfabetyczny (używający wielu wzorców przekształceń) szyfr strumieniowy.
- dopiero potem sformułował niezależnie od wcześniejszego odkrywcy (Frank Miller w 1882) reguły niemożliwego do złamania szyfru z kluczem jednorazowym (ang. one-time pad, OTP); 22 lipca 1919 został przyznany U.S. Patent 1,310,719 na przypominający OTP wykorzystujący XOR (Szyfrowanie to dodanie modulo 26 jednego znaku tekstu jawnego i znaku jednorazowego klucza). Pierwotna idea Vernama to była zapętlona taśma dalekopisowa, co nie było dobrym rozwiązaniem. Możliwe były też inne przekształcenia albo dwie niejednakowej długości taśmy perforowane dające długi okres kryptograficzny klucza.
- Vernom opisuje w artykule w AIEE journal w lutym 1926 użycie dwóch zapętlonych taśm o niejednakowej długości ok. 2 m.

Dopiero później wprowadzono ideę jednorazowego klucza. Joseph Mauborgne udowodnił, że jeżeli klucz jest całkowicie przypadkowy, szyfr jest matematycznie nie do złamania. Pomieszanie pojęc wynika z tego, że "szyfr Vernama" czasem oznacza szyfr strumieniowy, czasem zapętlony klucz dalekopisu, ale najczyściej OTP, choć jak widać Vernam samego OTP nie wymyślił, tym bardziej nie on udowodnił jego siłę.

Jakkolwiek sama idea szyfru, który nie da się złamać, brzmi bardzo atrakcyjnie, to szereg warunków, które trzeba spełnić, sprawia, że rzecz jest bardzo trudna do praktycznej realizacji:

- potrzebny jest klucz zawierający kompletnie przypadkowe dane
- klucz musi być dłuższy niż wiadomość
- muszą go posiadać obie strony komunikacji i musi pozostać ich tajemnicą, bo każdy kto go posiada, może odczytać wiadomość
- nigdy nie może zostać użyty ponownie ani w całości, ani w części

Najważniejszym problemem jest dystrybucja kluczy. Inną trudnością jest samo generowanie przypadkowych i niepowtarzalnych sekwencji znaków, sowieci zatrudniali maszynistki z zasłoniętymi oczami, które na maszynie wystukiwały serie przypadkowych znaków. Nawet zapewnienie dyscypliny użytkowników potrafi nastręczyć trudności.

Choć Vernam miał na mysli dalekopis to powstały uproszczone aplikacje OTP zdatne do użytku polowego.

Kkryptolodzy niemieckiego MSZ: Werner Kuntze, Rudolf Schauffler i Erich Langlotz zaproponowali jednorazowe bloczki szyfrowe. Na 50 stronach zapisano tablice każda ma 48 pięciocyfrowych liczb. Najpierw przekształcano tekst jawny w ciąg cyfr potem dodawano do nich cyfry klucza (modulo 10). Odszyfrowanie to samo tylko w drugą stronę. W latach 1921–1923 takie bloki wprowadzono do użytku w niemieckiej korespondencji dyplomatycznej.

Używano również bloczków z literami, wtedy i klucz i tekst jawny zamieniano na dwucyfrowe liczby, potem je dodawano (modulo 26).

Cryptographically-secure pseudorandom number generator, SPRNG.

Skutkiem odkrycia było zainteresowanie i rozwój elektromechanicznych urządzeń szyfrujących oraz OTP (one time pad).

- [Szyfr z kluczem jednorazowym](https://pl.wikipedia.org/wiki/Szyfr_z_kluczem_jednorazowym)
- Crypto Museum [One-Time Pad OTP](https://www.cryptomuseum.com/crypto/otp/index.htm)

### Maszyny rotorowe

Okres międzywojenny został zdominowany elektromechanicznymi maszynami rotorowymi.

Istniały trzy niezależne linie rozwojowe:

- Hebern (USA)
- Hagelin (Szwecja, od 1940 Szwajcaria)
- Scherbius (niemiecka Enigma)

Analiza słabości konstrukcji Heberna oraz informacje o europejskich urządzeniach sprawiły, że William F. Freedman skonstruował maszynę SIGABA używaną przez US Army od 1940. Nie złamana. Była utajniona aż do 2001, więc pomimo technicznej doskonałości nie wpłynęła na inne konstrukcje.

### Hebern Rotor Machine

Edward Hugh Hebern (USA, patent 1917) słaba maszyna bez sukcesu komercyjnego.

Udało mu się sprzedać ogólnie ok. 100 maszyn, w tym 12 dla US Navy. Ostatecznie biznes zbankrutował mimo intensywnej promocji. Jak się później okazało spory udział w tej klęsce miał Wiliam Friedman, który ocenił ją bardzo negatywnie.

### Hagelin

Tak naprawdę to Damm/Hagelin, ponieważ inicjatywa i początek biznesu to Arvid Gerhard Damm, ale finalnie w jego wykonaniu rzecz była skazana na porażkę. Jego dzieło kontynuował i w sukces przekuł Boris Hagelin. Obaj byli Szwedami. Tutaj podobnie jak w przypadku Painvina mamy wiele sprzecznych ze sobą wersji, ale będę się trzymał tego, co napisał David Kahn, bo jest to udokumentowane i spójne.

Arvid Gerhard Damm: uzdolniony inżynier i konstruktor, jego pierwsza maszyna szyfrująca powstała w 1914 (Cryptotyper), 1916 współzałożyciel Aktiebolaget Cryptograph, w której inwestorami byli Emmanuel Nobel (bratanek te. I tak w 1879 r. I. Derevyankin, główny mechanik petersburskiego okręgu telegraficznego, zaproponował oryginalne urządzenie do szyfrowania telegramów, które nazwał "kryptografem" [Soboleva, 2002]. Urządzenie to przypominało słynny renesansowy scrambler - dysk Albertiego. Urządzenie składało się z dwóch dysków, z których górny był ruchomy.go Nobla) i K. W. Hagelin dyrektor spółki naftowej Noblów w Baku (dlatego jego syn Boris ma takie imię). 1917 A-1 aka Mecano Cryptographer. Wniosek patentowy 10 października 1919. A-1b 1921 Electromechanical Cryptographer.

Brzmi to interesująco, ale ciągle nie ma zysków. Damm byłby świetnym bohaterem zarówno dramatu, jak i komedii, zdecydowanie brakowało mu dyscypliny i rzetelności, jego życie osobiste... ok zostawmy to, pierwsza maszyna szyfrująca, którą oferowano na sprzedaż zagraniczną (1925 Paryż, 1926 Haga) Model B 1, była kompletną porażką. Od 1922 z polecenia Nobla i Hagelina ojca w firmie był Boris Ceasar Wilhelm Hagelin, który miał nadzorować ich inwestycje. Tymczasem Damm popadł w tarapaty finansowe i nie miał żadnych sukcesów. Hagelin natomiast posiadając solidne wykształcenie techniczne, poprawił jego maszynę i jako Model B-21 zaoferował armii szwedzkiej. Zdobył wielkie zamówienie. W 1925 praktycznie przejmuje zarządzanie firmą.

W 1927 (lub jak inne źródła mówią w 1928) Damm już na marginesie firmy umiera w wieku 58 lat. Aktiebolaget Cryptograph w fatalnej kondycji, ale z dobrymi perspektywami została kupiona przez grupę kapitałową Nobla i Hagelina i od tej pory działa jako Aktiebolaget Cryptoteknik. Boris Hagelin jest dyrektorem i głównym konstruktorem.

W 1936 nawiązał pierwsze kontakty z kryptologami amerykańskimi zainteresowanym jego maszyną B-36, przed wojną wyjechał dwa razy do USA w 1937 i 1939. 9 kwietnia 1940 z radia dowiedział się, że Niemcy napadli na Norwegię i natychmiast uciekł z żoną i dokumentacją techniczną, przez Berlin do Szwajcarii. Włoskim statkiem przypłynęli do Nowego Jorku. Szwedzką firmą zarządza zdalnie. Dopiero po wojnie wracają do Europy.

W 1948 z powodów finansowych i politycznych przeniósł laboratorium ze Sztokholmu do Zug w Szwajcarii, a w 1959 całą resztę firmy, która od tej pory działała jako Crypto Aktiengesselschaft (Crypto AG). W 1955 zawarł porozumienie z NSA gwarantujące Amerykanom backdoora we wszystkich jego urządzeniach.

Zmarł w 1983 w wieku 91 lat, jak to pisze Kahn, jako jedyny konstruktor maszyn szyfrujących, który zbił na nich majątek.

- [Arvid Gerhard Damm](https://www.cryptomuseum.com/people/damm/arvid.htm)
- [Boris Hagelin](https://www.cryptomuseum.com/people/hagelin/boris.htm)

#### Hagelin B-21 / B-211

Hagelin B-21 to było właśnie to urządzenie, które w 1926 kupiła od niego szwedzka armia. Był to uproszczony, poprawiony i dostosowany do użytku polowego Model B 1. Pod wpływem Enigmy dodał lampki.

Mechanizm szyfrujący składał się z walców mających niejednakową liczbę bolców na obrzeżach. Bolce mogły być wysunięte lub cofnięte (bierne). Podstawienie polialfabetyczne z okresem równym iloczynowi wszystkich bolców. Przypisanie wierszy i kolumn na szachownicy 25x25.

W 1932 powstała kolejna wersja B-21 czyli B-211. Zamiast lampek miała drukarkę. Waga 18 kg, 200 znaków na minutę, rozmiar niewielkiej przenośnej skrzynki.

Pierwszym kupcem była sieć przedstawicielstw Ericssona w Ameryce Południowej. 500 tych maszyn zostało wyprodukowanych przez L.M. Ericsson w Colombes k Paryża i tuż przed wybuchem wojny dostarczonych armii francuskiej. Po wojnie zamówili kolejne 100. 

- [B-21](https://www.cryptomuseum.com/crypto/hagelin/b21/index.htm)
- [Hagelin B-211](https://www.cryptomuseum.com/crypto/hagelin/b211/index.htm)

#### Hagelin C-35 / C-36 / C-37

Z oczywistych powodów Francuzi nie chcieli niemieckiej maszyny szyfrującej. Pod koniec lat 20. Enigmy używała Reichwehra. Armia francuska złożyła u Hagelina kolejne zamówienie, tym razem wydawałoby się niemożliwe do realizacji: kieszonkowa maszyna drukująca szyfrogramy, obsługiwana przez jednego człowieka (w przypadku lampek było potrzebnych trzech ludzi, jeden obsługiwał klawiaturę, drugi na głos odczytywał litery z lampek, trzeci zapisywał).

Hagelin wiedząc, że próba miniaturyzacji istniejących maszyn jest ślepą uliczką, spróbował z drugiej strony - wystrugał z drewna model docelowej wielkości, mieszczący się w regulaminowej kieszeni i zaczął się zastanawiać jaki mechanizm mógłby się zmieścić w środku i jak można by takie urządzenie używać.

Ostatecznie połączył dwie maszyny w jednej. Dotychczasowy bęben znany z B-21 połączył ze zliczarką monet, do której miał prawa, bo klient, który ją zamówił, wycofał się z kupna. Był to rodzaj cylindrycznej klatki z prętów, na których były uchwyty. Walce miały kolejno 25, 26, 21, 19 i 17 kroków co zapewniało okres 3,900,225. Bolce z walców łączyły się z uchwytami na prętach - stąd określenie tego mechanizmu "pin-and-lug" (bolec i uchwyt), który odtąd staje się klasycznym rozwiązaniem Hagelina. Wprawdzie wymagana kieszeń jest dość spora, ale powstaje najmniejsze urządzenie szyfrujące na świecie: waga 1,5 kg, wielkość 15x11x5 cm.

Literę wprowadzono przez wybór pokrętłem, potem obrót korbką uruchamiał szyfrowanie i druk na gumowanej taśmie. Wyszkolony operator osiągał szybkość 25 znaków na minutę.

Armia francuska natychmiast zamówiła 5 tysięcy tych maszyn.

C-36 i C-37 to zmodyfikowane nieco wersje, mające inną konfigurację sprzętową.

- [Hagelin C-35](https://www.cryptomuseum.com/crypto/hagelin/c35/index.htm)
- [Hagelin C-36](https://www.cryptomuseum.com/crypto/hagelin/c36/index.htm)
- [Hagelin C-37](https://www.cryptomuseum.com/crypto/hagelin/c37/index.htm)

#### Hagelin BC-38 / BC-543

Elektromechaniczna maszyna szyfrująca, rozwinięcie mechanicznej C-38. Wyposażona w motor i klawiaturę (to właśnie oznacza litera B). Zbudowana 1938.

Wielkość 34x32x12 cm, zasilanie z sieci 110 lub 220 V. Możliwość działania wyłącznie mechanicznego co w warunkach wojennych jest ogromną zaletą. Drukarka jest podwójna, może jednocześnie drukować szyfrogram (do wysłania) i tekst jawny (do archiwizacji).

Używana podczas WWII głównie przez US Army. Po wojnie przez Szwecję i Norwegię.

BC-543 to nieco ulepszona i w pełni kompatybilna wersja BC-38.

Popularna w US Army.

- [Hagelin BC-38](https://www.cryptomuseum.com/crypto/hagelin/bc38/index.htm)

#### M-209

Najliczniej produkowana wojskowa maszyna szyfrujaca na świecie. Dostosowana do potrzeb US Army BC-38, znana jako M-209 w US Army, w US Navy nazywana CSP-1500, Niemcy mówili na nią AM-1 (Amerikanische Maschine Nr. 1). Wielkość 178x140x83 mm.

W 1942 w zatrudniającej 900 robotników fabryce L.C. Smith & Corona Typewriters Inc. w Groton (stan Nowy Jork) produkowano dziennie 400 M-209 (dla porównania, również dziennie 600 maszyn do pisania). Ogółem wyprodukowano ich 140 tys.

Czasem używana w tej samej sieci łączności razem z wersją zmotoryzowaną, czyli BC-543.

Nie dawała wielkiego zabezpieczenia kryptograficznego. W 1943 Niemcy potrzebowali 4h do odczytania wiadomości, ale ponieważ używano och do łączności na poziomie taktycznym, takie zabezpieczenie wystarczało.

W 1952 zastąpiona przez C-52 i CX-52.

- [M-209](https://www.cryptomuseum.com/crypto/hagelin/m209/index.htm)

#### Hagelin C-443 / C-48 / C-48A

Seria mechanicznych maszyn szyfrujących, będących kontynuacją rozwiązań Hagelina z lat 30.

w 1946 na podstawie doświadczeń wojennych powstaje Hagelin C-446.

- [Hagelin C-443](https://www.cryptomuseum.com/crypto/hagelin/c443/index.htm)
- [Hagelin C-446](https://www.cryptomuseum.com/crypto/hagelin/c446/index.htm)

### Enigma

Arthur Scherbius i Richard Ritter (Niemcy). Wniosek patentowy 23 lutego 1918.

Obaj przedstawili projekt maszyny zarówno niemieckiej Kriegsmarine, jak i Ministerstwu Spraw Zagranicznych, ale nie uzyskali zainteresowania żadnej z tych instytucji.

Wobec tego przekazali prawa patentowe założonej przez nich firmie Gewerkschaft Securitas. 9 lipca 1923 przekształciła się w Chiffriermaschinen Aktien-Gesellschaft (Maszyny Szyfrujące Spółka Akcyjna), w której Scherbius i Ritter zostali członkami zarządu.

Scherbius w 1928 wykupił nieużywany komercyjnie patent Holendra Hugo Kocha.

Enigma szczegółowo zostanie opisana w kolejnym wpisie.

Tak więc podsumowując, w okresie międzywojennym na rynku komercyjnym konkurowały tylko dwie konstrukcje:

- **Enigma** Scherbiusa, który skorzystał z cudzej idei, a ostatecznie, choć zainspirowała cały świat, była kolejną katastrofą armii niemieckiej
- **Hagelin**, czyli biznes przejęty od oryginalnego wynalazcy, który po latach został celowo skompromitowany przez właściciela

### Polska

**Uwaga: ten rozdział ma charakter tymczasowy do czasu napisania kolejnego wpisu dotyczącego ściśle samej Enigmy. Chcę oddzielić sprawę dekryptażu Enigmy od reszty polskiej kryptologii do 1945.**

#### Formowanie

Eugeniusz Chilarski, oficer armii CK Austrii, po odzyskaniu niepodległości przyjęty do Wojska Polskiego w stopniu kapitana. Adiutant Polskiej Wojskowej Komisji Likwidacyjnej w Wiedniu, potem przydzielony do Sztabu Generalnego, gdzie na przełomie 1918/19 kierował Sekcją Organizacyjną w Oddziale VI Informacyjnego (wywiad i kontrwywiad wojskowy) a potem od sierpnia już w stopniu majora kierował Wydziałem Mobilizacyjnym w Oddziale I Organizacyjno–Mobilizacyjnym.

W lutym 1919 Sekcję Szyfrów przejął kapitan Józef Stanslicki również dawny oficer CK Austrii. Opracował szyfry do komunikacji radiotelegraficznej Naczelnego Dowództwa z placówkami zagranicznymi, Dowództwami Okręgów Generalnych, dowództwami frontowymi: kod stacyjny – St. (Stanslicki) wraz z dodanymi cyframi rzymskimi (od I do IX) oraz szyfry St. I – XL, czyli 40 odmian, tzw. zmienników, zmienianych co kilka dni.

Dowództwa frontów i dowództwa dywizji korzystały nadal z Kodu Ch. i szyfru "Sigma" opartego na wzorach austro-węgierskich.

Tworzenie struktur polskiego radiowywiadu - major Karol Bołdeskuł.  Od końca listopada 1918 polskie radiostacje prowadziły systematyczny nasłuch sieci radiowych i ruchu radiowego wszystkich państw sąsiednich.

Już w styczniu 1919 przy Sztabie Generalnym powstała sekcja spraw organizacyjnych i szyfrów pod dowództwem kapitana Eugeniusza Chilarskiego. 11 maja 1919 została przemianowana na Oddział II Informacyjny, w którym była m.in. Sekcja Szyfrowa.

#### Bitwa warszawska 1920

#### Biuro Szyfrów

Latem 1931 nastąpiła reorganizacja i z połączenia Referatu Radiowywiadu oraz Referatu Szyfrów Własnych powstało Biuro Szyfrów. Jego pierwszym i głównym zadaniem było złamanie Enigmy.

Kuzynem Hermana Pokornego był major dyplomowany Franciszek Pokorny. Przez większość służby był zwykłym oficerem piechoty, ale w 1923 roku został wyznaczony na stanowisko szefa komórki radiowywiadu (Referat Radia i Szyfrów), która dysponowała stacjami nasłuchowymi: w Warszawie, Starogardzie Gdańskim, Poznaniu i Krzesławicach k. Krakowa. Ponadto Pokorny, po inżynierze Antonim Palluthu i kapitanie Maksymilianie Ciężkim był trzecim wykładowcą na tajnym kursie w Poznaniu w 1929. Z osób, które wyróżniły się na tym kursie, sformowano Biuro Szyfrów.

10 lat później Marian Rejewski we Francji odkrył, że kurs był prowadzony na podstawie książki generała Marcela Givièrge "Cours de cryptographie" z 1925.
